class Rape{constructor(file){this._='20210305';this.file=file;this.type=null;this.image=null;this.canvas=null;console.log('//github.com/netcrashed/rape.js?'+this._)};chew(part){switch(typeof(part)){case'object':if(!part.byteLength){return false};part=[...new Uint8Array(part)].map(b=>b.toString(16).padStart(2,'0')).join('');break;case'string':if(!part){return false};let raw=atob(part);part='';for(let i=0;i<raw.length;i++){let val=raw.charCodeAt(i).toString(16);part+=(val.length===2?val:'0'+val)};break;default:return false;break};if(!part){return false}else if(part.slice(0,12)=='474946383961'||part.slice(0,12)=='474946383761'){this.type='gif'}else if(part.slice(0,6)=='ffd8ff'){this.type='jpg'}else if(part.slice(0,16)=='89504e470d0a1a0a'){this.type='png'}else if(part.slice(0,4)=='424d'){this.type='bmp'}else if(part.slice(0,8)=='00000100'||part.slice(0,8)=='00000200'){this.type='ico'}else if(part.slice(0,8)=='52494646'&&part.slice(16,24)=='57454250'){this.type='webp'}else{return false};if(this.type=='jpg'){};return true};init(){return new Promise((done,fail)=>{if(typeof(this.file)=='object'){let reader=new FileReader();reader.readAsArrayBuffer(this.file.slice(0,65760));reader.onload=()=>{this.chew(reader.result)?done():fail()};reader.onerror=()=>{fail()}}else if(typeof(this.file)=='string'&&this.file.slice(0,4)=='blob'){let loader=new XMLHttpRequest;loader.responseType='arraybuffer';loader.onload=()=>{this.chew(loader.response.slice(0,65760))?done():fail()};loader.onerror=()=>{fail()};loader.open('GET',this.file);loader.send(null)}else if(typeof(this.file)=='string'&&this.file.slice(0,4)=='data'){let head=this.file.indexOf(',');this.chew(this.file.slice(head+1,head+87681))?done():fail()}else{fail()}})};async info(){await this.init();return this}};